# 제품 태그 자동화 시스템 설계 및 구현 가이드

## 1. 개요

### 1.1 현재 문제점
- 제품의 태그(`product_name`, `category`, `company`, `tags`)를 Discord 봇 명령어를 통해 수동으로 입력
- 전체 2,453개 제품 중 태그가 있는 제품은 54개(2.2%)에 불과함
- 수동 작업으로는 감당하기 어려운 양의 데이터

### 1.2 해결 방안
- 자동화 알고리즘을 통해 `sale_name`과 `data` JSON 필드에서 패턴을 분석해 자동으로 태그 부여
- Kiwipiepy 형태소 분석기를 활용한 텍스트 분석으로 정확도 향상
- 사용자 피드백을 학습에 반영하여 지속적으로 알고리즘 개선

## 2. 구현 계획

### 2.1 Kiwipiepy 기반 태깅 시스템 구현 (2-3일)
- Kiwipiepy 라이브러리 설치 및 초기화
- 사용자 정의 사전 구축 (브랜드명, 카테고리 용어 등을 사전 파일로 관리)
- `ProductTagger` 클래스 구현 (형태소 분석 기반 매칭)
- Discord 명령어 기본 구조 구현

### 2.2 다양한 플랫폼 처리 (1-2일)
- 각 플랫폼별 JSON 구조 분석 및 공통 추출 로직 구현
- 유연한 data JSON 파싱 로직으로 다양한 플랫폼 지원
- 플랫폼별 특수 로직 처리 (필요시)

### 2.3 피드백 시스템 구현 (1-2일)
- 간단한 피드백 데이터베이스 구조 설계
- 사용자 피드백을 Kiwipiepy 사용자 사전에 자동 반영
- Discord UI 개선 (버튼, 모달 등)

### 2.4 테스트 및 최적화 (1일)
- 간단한 베타 테스트 진행
- 기존 태그와 자동 태그 비교 검증
- 필요시 경량화된 배치 처리 시스템 구현

## 3. 주요 기술 요소

### 3.1 Kiwipiepy 형태소 분석기
- 빠른 개발과 정확한 한글 처리를 위한 핵심 라이브러리
- 사용자 정의 사전을 활용한 하드코딩 최소화
- 오타 및 변형 단어에 강한 텍스트 처리

### 3.2 사용자 정의 사전 구성
```
# 회사/브랜드명
고드름 NNP -3.0
크로닉쥬스 NNP -3.0
파이브폰즈 NNP -3.0

# 이형태/오타 처리
이치스 이지스/NNP -3.0
파이브핀즈 파이브폰즈/NNP -1.0

# 카테고리 키워드
액상 NNG -2.0
기기 NNG -2.0
팟 NNG -2.0
코일 NNG -2.0
```

### 3.3 다양한 플랫폼 JSON 처리
- 공통 필드 우선 탐색 (title, name, description 등)
- 플랫폼별 특수 필드 매핑 테이블 구성
- 예외 처리를 통한 안정적 파싱

### 3.4 간단한 피드백 시스템
- 최소한의 피드백 DB 구조 (제품ID, 원본태그, 수정태그, 타임스탬프)
- 사용자 피드백을 사전에 즉시 반영하여 다음 분석에 사용
- 주기적인 사전 파일 백업 (필요시)

## 4. ProductTagger 클래스 핵심 로직

### 4.1 초기화 및 설정
- Kiwipiepy 인스턴스 생성 및 사용자 사전 로딩
- 정규식 패턴 컴파일 (용량, 니코틴 등 추출용)
- 환경설정 로딩 (옵션)

### 4.2 태그 추출 핵심 메서드
- 회사/브랜드명 추출 (`extract_company`)
- 카테고리 추출 (`extract_category`)
- 제품명 추출 (`extract_product_name`)
- 태그 추출 (`extract_tags`)
- 다양한 플랫폼 JSON 처리 (`parse_platform_data`)

### 4.3 피드백 처리 메서드
- 피드백 기록 (`record_feedback`)
- 사용자 사전 업데이트 (`update_user_dictionary`)
- 사전 파일 관리 (`save_dictionary`, `load_dictionary`)

## 5. 실용적 구현 접근법

### 5.1 빠른 개발과 점진적 개선
- 최소 기능으로 신속한 구현 후 테스트 진행
- 피드백을 통한 점진적 정확도 향상
- 코드 가독성과 유지보수성 중시

### 5.2 다양한 플랫폼 처리의 유연성
- 미지원 플랫폼 자동 감지 및 대응
- 제품 데이터 이상치 처리 로직 구현
- 플랫폼별 특수 케이스 예외 처리 추가

### 5.3 Discord 봇 인터페이스 간소화
- 직관적인 명령어 구조 (`;;auto_tag <제품ID>`)
- 간결한 결과 출력 형식
- 피드백 수집 용이한 UI 구성

## 6. 구현 일정 및 로드맵

### 6.1 1주차: 기본 시스템 구현
- 월: Kiwipiepy 라이브러리 설치 및 기본 사전 구성
- 화-수: 핵심 ProductTagger 클래스 구현
- 목-금: Discord 봇 명령어 및 기본 테스트

### 6.2 2주차: 개선 및 안정화
- 월-화: 다양한 플랫폼 처리 로직 추가
- 수: 피드백 시스템 구현
- 목-금: 테스트 및 버그 수정, 문서화

### 6.3 향후 개선 계획
- 자동 배치 처리 스케줄링
- 대시보드를 통한 태깅 현황 모니터링
- 태그 통계 및 추천 기능 개발
